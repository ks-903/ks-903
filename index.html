<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>Web voice</title>
</head>
<body bgcolor="skyblue" text="blue" >
  <audio id="audioElement2" loop src="mark3.mp3"></audio>

  <style>
  button {
  margin: 10px 0;
}
  </style>



<p class="tile": center;>voice test</p>
<form id="form1" action="#">
   <input type="text" id="input-message" id="btn" >
   <input type="reset"+"button" onclick="showMessage()"  value="送信">

 </form>
 <audio id="audioElement2" loop
 ></audio>
 <!-- type="button" -->
    <h2 style="text-align: center; size="14px""><button id="start-btn">start</button>
<button id="stop-btn"  >stop</button>
<div id="result-div" ></div>

<h1 style="text-align:center" id="content"></h1>

<script>
  const textbox2 = document.getElementById("input-message");
  const startBtn = document.querySelector('#start-btn');
  const stopBtn = document.querySelector('#stop-btn');
  const resultDiv = document.querySelector('#result-div');


  SpeechRecognition = webkitSpeechRecognition || SpeechRecognition;
  let recognition = new SpeechRecognition();
let synth = new SpeechSynthesisUtterance();
   synth.pitchSetting = 0.6;  // ピッチ 0(min) - 2(max), default 1.0
   synth.volumeSetting = 0.5; // 音量 0(min) - 1(max), default 1.0
synth.rateSetting = 0.4; // 話す速さ 0.1(min) - 10(max), default 1.0
   // 設定項目終わり
 // 話す速さ 0.1(min) - 10(max), default 1.0
      // 設定項目終わり




  recognition.lang = 'ja-JP';
  recognition.interimResults = true;
  recognition.continuous = true;


  let finalTranscript = ''
  recognition.onresult = (event) => {
    let interimTranscript = ''; // 暫定(灰色)の認識結果
    for (let i = event.resultIndex; i < event.results.length; i++) {
      let transcript = event.results[i][0].transcript;

      if (event.results[i].isFinal) {

      finalTranscript +=     transcript  ;


      } else {
  interimTranscript   =  transcript  ;
      }
      if (event.results[i].isFinal) {
      var u = finalTranscript;
      u  =  transcript;


      }

    }


    resultDiv.innerHTML = // 確定した(黒の)認識結果
      finalTranscript + '<i style="color:#ddd;">' + interimTranscript + '</i>' ;



if ((u == "クリア")||(u=="クリア。 ")||(u == " クリア ")||(u==" クリア。 ")) {

  setTimeout(function(){
location.reload();
},1000);
resultDiv.innerHTML = synth.text = "ではリセットします";
speechSynthesis.speak(synth);

}

if ((u == "トラッキング")||(u=="トラッキング。")||(u == " トラッキング")||(u==" トラッキング。")) {

  synth.text = "申し訳ございません、こちらはまだ、試作中の音声コマンです。";
  var mp4 = '<iframe src="ggg.html" scrolling = "no"  frameborder="0" width="481" height="300"></iframe>'

  content.innerHTML = mp4;

speechSynthesis.speak(synth);
}

if ((u == "BGM セット")||(u == "BGM セット")||(u == " BGM セット")||(u == " BGM セット")){
  document.getElementById("audioElement2").play();
   resultDiv.innerHTML= synth.text
  = "かしこまりました。では曲を勝手に自動再生します" ;


speechSynthesis.speak(synth);


}
if ((u == "BGM ランダムセット")||(u == "BGM ランダムセット")||(u == " BGM ランダムセット")||(u == " BGM ランダムセット")){


audioArr=['111.mp3','444.mp3','555.mp3','000.mp3','mikami77.mp3'];



var i ;


var audio = new Audio();
 k = function() {
num = Math.floor(Math.random() * audioArr.length);


if (num == audioArr.length) {
num = audioArr.length - 1;
}
audio.src = audioArr[num];
audio.play();
}


k("kk") ;




   resultDiv.innerHTML= synth.text =i
  = "かしこまりました。では曲を勝手に自動再生します" ;


speechSynthesis.speak(synth);






}


if ((u == "BGM チェンジ")||(u == "BGM チェンジ。")||(u == " BGM チェンジ")||(u == " BGM チェンジ。")){
audioArr().pause();


  resultDiv.innerHTML= synth.text
 = "かしこまりました。では現在の曲を停止して別の曲に切り替えます。" ;


 speechSynthesis.speak(synth);






 }
if ((u == "検索")||(u=="検索。")) {

  synth.text = "フィールドを押して音声入力をすると自動で検索が始まります。";


speechSynthesis.speak(synth);


var mp4 = '<iframe src="jjj.html" scrolling = "no"  frameborder="0" width="481" height="300"></iframe>'

content.innerHTML = mp4;

}

if ((u == "動画検索")||(u=="動画検索。")) {

  synth.text = "フィールドを押して音声入力をすると自動で検索が始まります。";


speechSynthesis.speak(synth);


var mp4 = '<iframe src="jj.html" scrolling = "no"  frameborder="0" width="481" height="300"></iframe>'

content.innerHTML = mp4;

}
if ((u == "画像検索")||(u=="画像検索。")) {

  synth.text = "フィールドを押して音声入力をすると自動で検索が始まります。";


speechSynthesis.speak(synth);


var mp4 = '<iframe src="j.html" scrolling = "no"  frameborder="0" width="481" height="300"></iframe>'

content.innerHTML = mp4;

}


if ((u == "使い方")||(u=="使い方。")){
          var mp4 = '<video src="ddd.mp4" loop autoplay ></video>';

          content.innerHTML = mp4;

setTimeout(function(){
          resultDiv.innerHTML = synth.text  = "以上です、ビデオを終了します。まりました。ではビデオで使い方を説明しますこちらです";
          speechSynthesis.speak(synth);
        },333000);

        setTimeout(function(){
        location.reload();

  },3370000);
resultDiv.innerHTML = synth.text  = "かしこまりました。ではビデオで使い方を説明しますこちらです";


      //テキスト表示
      }



  if ((u== "こんにちは")||(u=="こんにちは。")||(u=="こんばんは。")||(u =="こんばんは")||(u=="おはよん")||(u=="おはよん。")||(u =="おはようございます")||(u=="おはようございます。")||(u =="お疲れ")||(u=="お疲れ。")) {



  var x;
    var a =["こんにちはユーザー様","私は音声アシストks-903ですこんにちは","なんのご用件でしょうか?","こんばんわ,良い天気ですね","おはよう","こんにちは私はks-903です","お疲れ様です","グッとバイ"];

x=Math.floor(Math.random()*8);

     resultDiv.innerHTML = synth.text = a[x] ;
speechSynthesis.speak(synth);





  }
  if ((u== "開発者")||(u=="開発者。")||(u=="製作者")||(u =="制作者。")||(u=="作った人")||(u=="作った人。")||(u =="創作者")||(u=="創作者。")||(u =="発明者")||(u=="発明者。")) {



resultDiv.innerHTML = synth.text  = "かしこまりました。"+ u +" 音声コマンド、を訪ねてくださりありがとうございます。この"+ u +"は、google apiを基に ks 903事、久村システムに よって2017年に研究を開始し、発案されました。これからも様々な新機能を搭載して行きますので、お楽しみください。";
speechSynthesis.speak(synth);





  }
setInterval(function(){
  recognition.start();

},40000);

  }




const showMessage = () => {
      const textbox = document.getElementById("input-message");
      const inputValue = textbox.value;
synth.text = finalTranscript  = inputValue;
      //テキストボックスの値を使って、出力するメッセージを生成する
      const output =    "入力された内容は「" + inputValue + "」です。";
      //出力用のp要素にメッセージを表示
      resultDiv.innerHTML = output;
      initSynth.lang = "ja-JP";
      initSynth.rate   = 0.9;       // 速さ
      initSynth.pitch  = 0.5;       // 高さ
      initSynth.volume = 0.6;       // 音量
     speechSynthesis.speak(synth);


}



    textbox2.onclick = () => {




    initSynth = new SpeechSynthesisUtterance();
initSynth.text   = "この入力画面は聴覚障害者の人が喋れるようにアシストするためのツールです、入力をしたら送信をしてください。私があなたの思いを言葉にして伝えます。";
 initSynth.rate   = 0.9;       // 速さ
 initSynth.pitch  = 0.5;       // 高さ
 initSynth.volume = 0.6;
   resultDiv.innerHTML   = finalTranscript;
 speechSynthesis.speak(initSynth);
    

}
  startBtn.onclick = () => {



    iniSynth = new SpeechSynthesisUtterance("ksー９０３チャットボイス、バージョン０が起動されました");
   iniSynth.lang = "ja-JP";
   iniSynth.rate   = 0.9;       // 速さ
   iniSynth.pitch  = 0.5;       // 高さ
   iniSynth.volume = 0.6;       // 音量
  speechSynthesis.speak(iniSynth);
  setTimeout(function(){
    recognition.start();

},5600);
  }
 


  stopBtn.onclick = () => {
    recognition.stop();
  resultDiv.innerHTML =  synth.text  = finalTranscript;
    speechSynthesis.speak(synth);

  }
      </script>

